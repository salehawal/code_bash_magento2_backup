#!/bin/bash

######################
# Permissions | Development
######################

# Dedicated Server
find . -type f -exec chmod 644 {} \;
find . -type d -exec chmod 755 {} \;
find app/code var vendor pub/static app/etc generated/code generated/metadata var/view_preprocessed \( -type f -or -type d \) -exec chmod u-w {} \; && chmod o-rwx app/etc/env.php && chmod u+x bin/magento
chmod -R u+w .
echo 022 > magento-unmask
bin/magento setup:static-content:deploy en_US ar_SA -f
bin/magento indexer:reindex
bin/magento cache:clean
bin/magento cache:flush
echo "Build Done..."

find . -type f -exec chmod 644 {} \;
find . -type d -exec chmod 755 {} \;
find ./var -type d -exec chmod 777 {} \;
find ./pub/media -type d -exec chmod 777 {} \;
find ./pub/static -type d -exec chmod 777 {} \;
chmod 777 ./app/etc
chmod 644 ./app/etc/*.xml
chmod u+x bin/magento


# Shared Hosting
#find app/code lib pub/static app/etc generated/code generated/metadata var/view_preprocessed \( -type d -or -type f \) -exec chmod g-w {} \; && chmod o-rwx app/etc/env.php
#find app/code lib var generated vendor pub/static pub/media app/etc \( -type d -or -type f \) -exec chmod g+w {} \; && chmod o+rwx app/etc/env.php
echo "Permissions | Production for Shared Hosting Done..."